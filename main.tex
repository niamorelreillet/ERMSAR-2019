\documentclass[11pt]{article}\usepackage{geometry} \geometry{letterpaper, margin=25.4mm}
\usepackage{mathptmx}
\usepackage{layout}
\usepackage[blocks]{authblk}
\usepackage{titlesec}
\usepackage[english]{babel}
\usepackage{fancyhdr}
\usepackage{indentfirst}
\usepackage{hyperref}
\usepackage{array}
\usepackage{graphicx}
\usepackage{mathptmx} 
\usepackage[mathscr]{euscript}

\usepackage{diagbox}
\usepackage{pdfpages}

\usepackage{amsmath}
\usepackage{caption}
\usepackage{subcaption,color}
\usepackage{makeidx}
\usepackage{multirow}
\usepackage{xspace}
\usepackage{tabularx}
\usepackage{rotating}
\usepackage{float}
\usepackage{amsmath,amssymb,pifont,bbold}
\usepackage{tikz}
\usetikzlibrary{trees}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{arrows,shapes,patterns}
\usepackage{glossaries}
\usepackage{etoolbox}
\usepackage{bibunits}
\usepackage{sidenotes}
\usepackage{animate}
\usepackage{theorem}
\usepackage{enumitem}
\usepackage{booktabs}
\usepackage{mhchem}
\usepackage{lastpage}
\usepackage[shortcuts]{extdash}

\pagenumbering{arabic}
\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
\fancyhead[LO,LE]{\fontsize{8}{10}\selectfont \bf The 9TH European Review Meeting on Severe Accident Research (ERMSAR2019) \\ Clarion Congress Hotel, Prague, Czech Republic, March 18-20, 2019}
\fancyhead[RE,RO]{\fontsize{8}{10}\selectfont \bf Log Number: xxx \\~}
\renewcommand{\headrulewidth}{0pt}
\fancyfoot[RO,RE]{\fontsize{8}{10}\selectfont \bf \thepage/\pageref{LastPage}}

\setlength\parindent{0pt}
\setlength{\parskip}{1em}

% \renewenvironment{abstract}{\global\setbox\absbox=\vbox\bgroup
%   \hsize=\textwidth\def\baselinestretch{1}%
%   \noindent\unskip\begin{center}\textbf{Abstract}\end{center}
%  \par\medskip\noindent\unskip\ignorespaces}
%  {\egroup}

\captionsetup{labelsep=period,labelfont=bf,font={bf}}
\renewcommand{\thetable}{\Roman{table}}

\makeatletter
\patchcmd{\@maketitle}{\LARGE}{\fontsize{14}{17}\selectfont}{}{}
\makeatother

\renewcommand\Authfont{\bfseries}
\setlength{\affilsep}{0pt}
\titleformat{\section}{\bfseries}{\thetitle.}{1em}{\MakeUppercase}
\titlespacing*{\section}{0pt}{0pt}{0pt}
\titleformat{\subsection}{\normalfont\bfseries}{\thetitle.}{0.5em}{}
\titlespacing*{\subsection}{0pt}{0pt}{0pt}
\titleformat{\subsubsection}{\normalfont\bfseries}{\thetitle.}{0.2em}{}
\titlespacing*{\subsubsection}{0pt}{0pt}{0pt}
 
\bibliographystyle{ieeetr}

\newenvironment{legend}
{\tabular{r>{\small} p{0.9\textwidth}}}
{\endtabular}

\newcommand{\n}{\tabularnewline}
\newcolumntype{C}{>{\centering}X}
\newcolumntype{L}{>{\raggedright}X}
\newcolumntype{R}{>{\raggedleft}X}
\newcolumntype{M}[1]{>{\centering}m{#1}}

\newenvironment{remark}[1][\textit{Nota Bene}]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries \rule{1ex}{1ex} #1}]\ignorespaces}{\rule{1ex}{1ex} \end{trivlist}\ignorespacesafterend}

\setlist[itemize]{noitemsep, topsep=0pt}
\setlist[enumerate]{noitemsep, topsep=0pt}

% notations
\newcommand{\T}{\texttt}
\newcommand{\M}[1]{{\mathbb #1}}
\newcommand{\Mb}[1]{{\mathbf #1}}
\newcommand{\Mc}[1]{{\mathcal #1}}
\newcommand{\Ms}[1]{{\mathcal{} #1}}
\newcommand{\Hi}[1]{\underline{#1}}

\newcommand{\Eq}[1]{Eq.~\ref{eq:#1}}
\newcommand{\Eqs}[2]{Eqs.~\ref{eq:#1} and~\ref{eq:#2}}
\newcommand{\Eqss}[3]{Eqs.~\ref{eq:#1},~\ref{eq:#2} and~\ref{eq:#3}}
\newcommand{\Eqsss}[4]{Eqs.~\ref{eq:#1},~\ref{eq:#2},~\ref{eq:#3} and~\ref{eq:#4}}
\newcommand{\Fig}[1]{Figure~\ref{fig:#1}}
\newcommand{\Figs}[2]{Figures~\ref{fig:#1} and~\ref{fig:#2}}
\newcommand{\Figss}[3]{Figures~\ref{fig:#1},~\ref{fig:#2} and~\ref{fig:#3}}
\newcommand{\Tab}[1]{Table~\ref{tab:#1}}
\newcommand{\Tabs}[2]{Tables~\ref{tab:#1} and~\ref{tab:#2}}
\newcommand{\Tabss}[3]{Tables~\ref{tab:#1},~\ref{tab:#2} and~\ref{tab:#3}}
\newcommand{\Sect}[1]{Section~\ref{sect:#1}}
\newcommand{\Sects}[2]{Sections~\ref{sect:#1}~and~\ref{sect:#2}}
\newcommand{\Sec}[1]{\Sect{#1}}
\newcommand{\App}[1]{Appendix~\ref{app:#1}}

\include{notations_lpma}



\begin{document}

\title{\vspace{-1em}\bf \MakeUppercase{Consistent use of CALPHAD data for in-vessel corium pool modeling:} \\ \MakeUppercase{some analytical and practical considerations}}
\date{}

\author{R. Le Tellier}
\author{B. Habert}  
\author{V. Tiwari}  
\affil{CEA, DEN, DTN/SMTA/LMAG, Cadarache \\
  F-13108 Saint Paul-lez-Durance, France \\
  \underline{romain.le-tellier@cea.fr}, benoit.habert@cea.fr, vaishnvi.tiwari@cea.fr}
\author{N. Bakouta}
\affil{EDF Lab Paris-Saclay \\
  7, boulevard Gaspard Monge \\
  F-91120, Palaiseau, France \\
  nikolai.bakouta@edf.fr}

\maketitle

\thispagestyle{fancy}

\section*{Abstract}
abstract

\section*{\hfill Keywords}
\vskip -\baselineskip
\hfill \texttt{in-vessel corium, CALPHAD, thermodynamic properties, tabulation, interpolation}

\vskip \baselineskip
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This work pertains to the modeling of in-vessel corium pool within the framework of Severe Accident studies for Light Water Reactors (LWRs). Considering in particular ``In-Vessel Retention'' (IVR) safety strategies, a key element is the phenomenology associated with a corium pool that can be formed after the loss of the primary coolant and the induced core degradation. Indeed, the heat flux from the corium pool to the vessel wall determines the chances of success of a reactor pit reflooding strategy (``External Reactor Vessel Cooling'' ERVC). The behavior of a corium pool results from the combination of two main types of phenomena. While, the associated thermochemistry defines the segregation of the pool in different phases (both liquid and solid), thermohydraulics finally determines through natural convection (that may be laminar or turbulent depending on the size) the heat flux at the pool interface.

In this context, code cross-comparisons \cite{Bakouta2015} performed by CEA and EDF on the stratified in-vessel corium pool models of PROCOR (CEA, see \cite{LeTellier2015}) and EDF proprietary versions of MAAP4 \cite{maap4} and MAAP5 \cite{maap5} (indistinctly referred to as MAAP-EDF in the remainder) have shown that an important source of discrepancy is related to the associated thermodynamic representation of the sub-oxidized corium-steel system. The PIRT (Phenomena Identification Ranking Table, see \cite{Carenini2019a}) developed in the frame of the H2020 European project IVMR (In-Vessel Melt Retention) has also pointed out the prime importance of gaining knowledge for a more detailed modeling of the thermochemical peculiarities (e.g. liquid miscibility gap) of the corium-steel system. Indeed, the modeling of corium-steel thermochemical interactions in codes treating of in-vessel corium behavior is rather recent\footnote{For instance, first efforts for constructing transient stratification models can be traced back to the OECD MASCA program in the early 2000's \cite{Tsurikov2007}.} and is still very incomplete \cite{Carenini2018}. In particular, the recent results of the CORDEB experimental program \cite{Almjashev2018} have clearly shown the requirement for further studies regarding the thermochemical interactions between molten steel and suboxidized corium crust. 

In addition to thermochemical modeling aspects related to phase-component partitioning (e.g. for the liquid phases and the related phase stratification), such thermodynamic information is needed for the closures of thermal models, in particular in terms of enthalpy-temperature relations as a function of the composition for energy conservation equations.

As thermochemical models are introduced in codes that historically dealt only with corium thermalhydraulics, an issue is raised pertaining to the consistency of the corium-steel system thermodynamic representation underlying the different models or closures. In the case of the MAAP-EDF code, it was shown in \cite{Bakouta2015} that the native MAAP ``Equation-Of-State'' (EOS) that provides the closures (the specific enthalpy, the liquidus temperature and so on for a given material composition) to energy balance equations written in enthalpy is inconsistent with the findings of the MASCA project regarding corium-steel thermochemical interactions and, consequently, with the liquid phases stratification model proposed in \cite{LeTellier2014} and introduced in MAAP-EDF. It leads to erroneous temperatures at the interface between the liquid corium pool layers and the surrounding oxidic crust. 

In order to solve this consistency issue, a single, as exhaustive as possible, thermodynamic representation of the system should be used throughout all the different models and closures. Severe accident dedicated thermodynamic databases constructed by the CALPHAD method \cite{Lukas2007} offer such a representation. Actually, various thermochemical models that are used for in-vessel corium behavior are based in one way or the other on thermodynamical description of the corium system through databases obtained with the CALPHAD approach. Such databases are constructed in terms of mathematical models (with adjustable parameters fitted on experimental data \cite{Barrachin2004, Gueneau2015}) that represent the Gibbs energy of the different phases for low-order systems (in practice, binary and ternary systems). This information, through extrapolation, is used to calculate the Gibbs energy of higher-order systems in such a way that these databases, combined with a Gibbs energy minimizer code, can be used to calculate the thermodynamical properties of a system at isothermal equilibrium. Gibbs energy phase models in such databases also offer the possibility of extrapolating outside the thermodynamic stability range and consequently can be used in kinetic modeling of phase transformations.

In \cite{Tiwari2018}, as a first step towards a CALPHAD-based EOS for in-vessel corium, a preliminary study was carried out on a simple plane front solidification model for the ternary U-O-Zr system and the results have confirmed the feasibility of using the CALPHAD database to obtain thermodynamically consistent closures for the conservation equations. 

In this preliminary work, two major ``simplifications'' were made and require further analysis. On the one hand, under the hypotheses of this solidification model, both liquid and solid regions are monophasic in such a way that they can be directly related to the phases described in the CALPHAD database. In the general case, CALPHAD data should be supplemented by phase segregation hypotheses and models for the construction of the desired EOS. %It should be emphasized that these hypotheses should be made, as far as possible, consistent with in-vessel corium associated thermochemical models to which the thermal balance is coupled with. 
On the other hand, this solidification model, from the point of view of CALPHAD-derived quantities (including thermodynamic equilibria), makes direct use of a Gibbs energy minimizing code (the Open-Calphad code as interfaced in PROCOR, see \cite{Sundman2016}). Considering the complete modeling of in-vessel corium, for the sake of robustness and performances, this direct approach appears impractical. As a consequence, tabulation and interpolation strategies regarding the CALPHAD-based thermodynamic properties (e.g. \cite{Saad2015}) have to be envisaged.

This paper is focused on these two differents aspects associated with the consistent and practical use of CALPHAD data for in-vessel corium pool modeling.
First, different segregation hypotheses that can be made when constructing such an EOS are discussed and analyzed in \Sect{analytical} for the steel-corium system on a simple test case. Then, \Sect{practical} reports ongoing developments regarding the sampling, storage and interpolation of CALPHAD-based thermodynamic properties for the EOS construction. Conclusions and perspectives are proposed in \Sect{concl}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Comparing different segregation hypotheses for constructing an in-vessel corium EOS} \label{sect:analytical}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{analytical.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Sampling, storage and interpolation of CALPHAD-based thermodynamic properties} \label{sect:practical}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this second part of the paper, some considerations regarding the tabulation and interpolation strategies of CALPHAD-based thermodynamic properties for in-vessel corium are presented. As mentioned in the introduction, the ``mock-up'' model discussed in \cite{Tiwari2018} for the solidification for the ternary U-O-Zr system makes direct use of the Open-Calphad code. This direct approach raises two issues. 

First of all, the computational time associated with a Gibbs energy minimizing code may not be compatible with the requirements on execution time of the lumped parameter modeling for in-vessel corium. While parallel computing (in shared memory as reported in \cite{Sundman2016} for Open-Calphad) can be a valuable option for distributed parameters models (see, for instance, \cite{Introini2018} for the use of Open-Calphad in a nuclear fuel performance code), the associated benefits for lumped parameter models, that are typically used for Monte-Carlo based statistical study, is less clear. 

Then, considering the U-O-Zr-steel system, the peculiarities of its phase diagram (in particular, the liquid miscibility gap) can induce convergence issues (either non-convergence or misconvergence) when minimizing the Gibbs energy in order to calculate a thermodynamic equilibrium. Such a phenomenon was typically observed when producing the results depicted at \Fig{x-T_C32_1850}. More particularly, the root-finding problem associated with \Eq{t(h)} is solved by an iterative algorithm (Brent type) that can fail due to misconvergence in the underlying equilibrium calculations (e.g. ``flickering'' of the phases found at equilibrium in a limited temperature range). In the present study, such problems have reccurently appeared in the region where the two liquid phases and the solid face-centered cubic (U,Zr)O$_{2-x}$ phase phases coexist. A strategy based on the comparison of the Gibbs energy values obtained from equilibrium calculations with different parameters (in terms of miscibility gap treatment, database phases that are considered in the calculation and so on) for given composition and temperature have been used and was found successful to obtain the results of \Fig{x-T_C32_1850}. However, such a strategy increases the overall computational time and, in other cases, was not able to ensure convergence.

As a consequence, in the MAAP-EDF and PROCOR codes, tabulation and interpolation strategies regarding the CALPHAD-based thermodynamic properties have been envisaged and are under development. Taking into account the convergence issue that have just been discussed, a general dynamic interpolation scheme such as the one proposed in \cite{Larsson2015} has not been retained. From there, considering a ``static'' interpolation (where all interpolation points have been precalculated), one is faced, in the general case,  with a ``curse of dimensionality'' issue as the size of the variable space scales with the power of the number of components. 

However, in the framework of in-vessel corium modeling, this very general issue can be mitigated by:
\begin{itemize}
 \item reducing the ranges of compositions and temperature to the domain of interest for the associated corium models;
 \item adopting a adaptive-mesh refinement strategy for the construction of the interpolation grid.
\end{itemize}

Let us now discuss such a tabulation strategy that have been developed for thermodynamic equilibria.

Regarding the composition space, in-vessel corium is made of suboxidized corium (U-O-Zr system) relocated from the core and molten ablated structures or vessel wall made of different steels (Fe-Ni-Cr system). As a consequence, instead of spanning directly the composition space in terms of element mass fractions \textit{i.e.} $\left\{ \left\{\elementMassFraction[i]{}\right\}_{i\in \elementSet} \in \left[0,1\right]^{\dim(\elementSet)} : \sum_{i\in \elementSet} \elementMassFraction[i]{} = 1 \right\}$ where $\elementSet = \left\{U,Zr,O,Fe,Ni,Cr\right\}$, the interpolation points (in terms of composition) can be constructed according to the following variables:
\begin{itemize}
 \item the U/Zr molar ratio $R_{U/Zr}$ that is mainly associated with the reactor design and typically ranges from 0.8 for boiling light water reactors to 1.3 for pressurized light water reactors;
 \item the Zr molar oxidation degree $C_{Zr}$ that is scenario dependent and typically ranges between 30\% and 100\%;
 \item the ratio between the steel and suboxidized corium masses, $x_{steel}$.
\end{itemize}
The advantage of using such variables is that the associated domain is an hyperrectangle (in comparison to the hyperpyramid defined by the element mass fractions) that ease the use of local adaptive refinement and adequately cover the composition of interest for in-vessel corium modeling. Then, in terms of temperature, in-vessel models require data for ranging from $\Mc{T}_{liq}\left(\elementMassFraction[i]{}\right)_{i\in\elementSet}$\footnote{At the cooled boundary of the corium pool, a solid crust can be formed and, assuming local equilibrium, the interface temperature associated with solidification is the liquidus temperature of the liquid in the boundary layer.} to $\Mc{T}_{liq}\left(\elementMassFraction[i]{}\right)_{i\in\elementSet} + \Delta\temperature{}$ with $\Delta\temperature{}$ limited to a few hundreds of degrees. 

Based on such a composition and temperature space, a two-stage scheme is used for calculating and storing equilibria:
\begin{enumerate}
 \item phase transition calculations (associated with the apparition of the face-centered cubic (U,Zr)O$_{2-x}$ phase, \T{C1\_FCC}) for a oxyde-metal corium) are performed in order to evaluate the liquidus temperatures over composition space;
 \item based on the composition grid of the previous step, fixed-temperature equilibrium calculations are performed for temperature grids defined over $\left[\Mc{T}_{liq}\left(\elementMassFraction[i]{}\right)_{i\in\elementSet}, \Mc{T}_{liq}\left(\elementMassFraction[i]{}\right)_{i\in\elementSet} + \Delta\temperature{}\right]$.
\end{enumerate}

At both stage, an adaptive-mesh refinement strategy has been implemented. In order to illustrate it, let us take the example of the first calculation stage dedicated to the liquidus temperature tabulation. 

Considering an initial conforming coarse composition grid defined in terms of $R_{U/Zr}$, $C_{Zr}$, $x_{steel}$, phase transition calculations are performed for the different grid points. Then, an interpolation over these points is constructed\footnote{For the time being, we have used the so-called microsphere interpolation method proposed in \cite{Dudziak2007} and implemented in the Apache commons math library \cite{Apache2016}} and local refinement proceeds as follows; for each cell of composition hypercube grid,
\begin{enumerate}
 \item the liquidus temperature interpolated at the cell center is compared with a phase transition calculation performed for the associated composition;
 \item if the distance between these two values exceeds a given accuracy criterion, the cell is splitted along each axis into two;
 \item phase transition calculations are performed for all the newly created grid points.
\end{enumerate}
This refinement procedure can be iterated several times until the distance between interpolated and calculated values is small enough.

In addition, in order to circumvent possible convergence issues, we have introduced in the process an additional ``check'' step where, for a given grid, the associated calculated equilibria are checked in order to detect possible misconvergence problem. For instance, considering the first stage and the liquidus temperature calculation, such a verification is carried out by performing fixed-temperature equilibrium calculations around the previously calculated liquidus temperature to ensure that the threshold of solid phase apperance has been correctly evaluated. If it is not the case, equilibrium calculations by a temperature sweep are carried out in order to correct the evaluation of the liquidus temperature.

\emph{@Benoit: si tu peux ajouter une ou deux figures pour illustrer et commenter, je suis preneur !}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions and perspectives} \label{sect:concl}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Acknowledgments}

This work is funded by the IVMR grant agreement number 662157 (H2020) and, in the framework of the PROCOR platform development, by CEA, EDF and Framatome.

\bibliography{../../References/lma-jabref}

\end{document}
